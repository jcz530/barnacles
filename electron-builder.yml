appId: app.barnacles.app
productName: Barnacles
copyright: Copyright Â© 2025 Joe Czubiak

# Build directories
directories:
  output: dist
  buildResources: build

# Only install production dependencies
npmRebuild: false
buildDependenciesFromSource: false
nodeGypRebuild: false

# Only include essential files for production
files:
  - 'dist/**/*'
  - 'package.json'
  - 'node_modules/**/*'
  # Exclude test files and documentation
  - '!node_modules/**/test{,/**/*}'
  - '!node_modules/**/tests{,/**/*}'
  - '!node_modules/**/*.test.*'
  - '!node_modules/**/*.spec.*'
  - '!node_modules/**/README.*'
  - '!node_modules/**/CHANGELOG.*'
  - '!node_modules/**/.github{,/**/*}'
  - '!node_modules/**/*.md'
  # Exclude source maps and TypeScript files
  - '!node_modules/**/*.map'
  - '!node_modules/**/*.ts'
  - '!node_modules/**/tsconfig.json'

# Include/exclude node modules patterns
# Note: Only unpack native modules that need direct file system access
# Disabled asarUnpack to avoid issues with missing optional dependencies
# asarUnpack:
#   - '**/node_modules/@libsql/**'

# Include migrations as extra resources
extraResources:
  - 'migrations/**/*'

# Icons
icon: assets/icons/app

# Auto updater
publish:
  provider: github
  owner: jcz530
  repo: barnacles
  releaseType: release

# macOS configuration
mac:
  icon: assets/icons/app.icns
  category: public.app-category.productivity
  hardenedRuntime: true
  gatekeeperAssess: false
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  notarize: true
  target:
    - target: dmg
      arch:
        - arm64
    - target: zip
      arch:
        - arm64

afterSign: scripts/notarize.cjs

# DMG configuration with custom background
dmg:
  title: '${productName} ${version}'
  icon: assets/icons/app.icns
  background: assets/dmg-background.png
  # backgroundColor: 'F6E3EF'
  window:
    width: 540
    height: 380
  contents:
    - x: 140
      y: 200
      type: file
    - x: 400
      y: 200
      type: link
      path: /Applications

# Windows configuration
win:
  icon: assets/icons/app.ico
  target:
    - target: nsis
      arch:
        - x64
        - ia32

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: always

# Linux configuration
linux:
  icon: assets/icons/app.png
  category: Utility
  target:
    - target: AppImage
      arch:
        - x64
    - target: deb
      arch:
        - x64
    - target: rpm
      arch:
        - x64
