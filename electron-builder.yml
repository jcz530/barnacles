appId: app.barnacles.app
productName: Barnacles
copyright: Copyright Â© 2025 Joe Czubiak

# Build directories
directories:
  output: dist
  buildResources: build

# Only install production dependencies
npmRebuild: false
buildDependenciesFromSource: false
nodeGypRebuild: false

# Only include essential files for production
files:
  - 'dist/**/*'
  - 'package.json'
  - 'node_modules/**/*'
  # Exclude dev dependencies
  - '!node_modules/electron{,/**/*}'
  - '!node_modules/electron-builder{,/**/*}'
  - '!node_modules/@electron{,/**/*}'
  - '!node_modules/typescript{,/**/*}'
  - '!node_modules/prettier{,/**/*}'
  - '!node_modules/eslint{,/**/*}'
  - '!node_modules/@typescript-eslint{,/**/*}'
  - '!node_modules/@types{,/**/*}'
  - '!node_modules/vite{,/**/*}'
  - '!node_modules/@vitejs{,/**/*}'
  - '!node_modules/nodemon{,/**/*}'
  - '!node_modules/concurrently{,/**/*}'
  - '!node_modules/drizzle-kit{,/**/*}'
  - '!node_modules/app-builder-bin{,/**/*}'
  - '!node_modules/7zip-bin{,/**/*}'
  - '!node_modules/@tailwindcss{,/**/*}'
  - '!node_modules/tailwindcss{,/**/*}'
  - '!node_modules/lightningcss-darwin-arm64{,/**/*}'
  # Exclude test files and documentation
  - '!node_modules/**/test{,/**/*}'
  - '!node_modules/**/tests{,/**/*}'
  - '!node_modules/**/*.test.*'
  - '!node_modules/**/*.spec.*'
  - '!node_modules/**/README.*'
  - '!node_modules/**/CHANGELOG.*'
  - '!node_modules/**/.github{,/**/*}'
  - '!node_modules/**/*.md'
  # Exclude source maps and TypeScript files
  - '!node_modules/**/*.map'
  - '!node_modules/**/*.ts'
  - '!node_modules/**/tsconfig.json'

# Include/exclude node modules patterns
# Note: Only unpack native modules that need direct file system access
asarUnpack:
  - 'node_modules/@libsql/**/*'

# Include migrations as extra resources
extraResources:
  - 'migrations/**/*'

# Icons
icon: assets/icons/app

# Auto updater
publish:
  provider: github
  owner: jcz530
  repo: barnacles
  releaseType: release

# macOS configuration
mac:
  icon: assets/icons/app.icns
  category: public.app-category.productivity
  hardenedRuntime: false
  gatekeeperAssess: false

# DMG configuration with custom background
dmg:
  title: '${productName} ${version}'
  icon: assets/icons/app.icns
  background: assets/dmg-background.png
  # backgroundColor: 'F6E3EF'
  window:
    width: 540
    height: 380
  contents:
    - x: 140
      y: 200
      type: file
    - x: 400
      y: 200
      type: link
      path: /Applications

# Windows configuration
win:
  icon: assets/icons/app.ico
  target:
    - target: nsis
      arch:
        - x64
        - ia32

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  createDesktopShortcut: always

# Linux configuration
linux:
  icon: assets/icons/app.png
  category: Utility
  target:
    - target: AppImage
      arch:
        - x64
    - target: deb
      arch:
        - x64
    - target: rpm
      arch:
        - x64
